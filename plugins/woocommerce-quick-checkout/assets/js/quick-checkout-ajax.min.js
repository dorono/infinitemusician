var quick_checkout;!function(a){var b,c,d,e,f=".quick-checkout, .quick-checkout-link, .quick-checkout-button-shortcode, .quick-checkout-product, .qc-trigger-autoload, .quick-checkout-now",g="",h=a(".quick-checkout-frame form.login"),i={init:function(){return"checkout_not_set"==quick_checkout.checkout_url?!1:(a(document.body).on("click touchend",f,i.qc_clicked),a(".qc-trigger-autoload").trigger("click"),i.hide_all_except_checkout(),a(window).load(i.window_load),a(".quick-checkout-product-replace").prevAll(".single_add_to_cart_button").remove(),void h.on("submit",i.login_form_submitted))},qc_clicked:function(b){return b.preventDefault(),c=a(this),c.hasClass("wc-variation-selection-needed")?!1:(c.addClass("loading").prop("disabled",!0),c.closest(".product").addClass("quick-checkout-active-loading"),e=a.extend({},{quantity:1},i.qc_get_object(c)),c.hasClass("quick-checkout-gform-button")?(i.gravity_form_support(e),!1):(c.hasClass("quick-checkout-link")&&0==a("[id^=quick-checkout-]").length&&c.after('<div id="quick-checkout-0"></div>'),void i.qc_open_checkout(e)))},qc_open_checkout:function(b){switch(d=a("#quick-checkout-"+b.product_id),d.length||(d=c.parents(".qc-woo-shortcode-wrap").find("[id^=quick-checkout-]")),d.length||(d=a(document.body).find("[id^=quick-checkout-]")),b.checkout_action){case"onpage":i.onpage_checkout(d,b);break;case"reveal":i.reveal_checkout(d,b);break;case"lightbox":i.lightbox_checkout(d,b)}},onpage_checkout:function(a,b){i.init_frame("onpage",b),a.show()},reveal_checkout:function(b,d){a(document.body).hasClass("single-product")||a(document.body).hasClass("woocommerce-page")||c.hide(),b.show(),c.closest(".product").removeClass("quick-checkout-active-loading"),i.init_frame("reveal",d)},lightbox_checkout:function(a,b){i.qc_open_modal(),i.init_frame("lightbox",b)},init_frame:function(c,e){switch(a(document.body).find("iframe.qc-frame").remove(),c){case"lightbox":b=a('<div id="quick-checkout-modal" class="qc-clearfix"><button class="mfp-close" type="button" title="Close (Esc)">Ã—</button><iframe src="" scrolling="no" style="overflow:hidden;width:100%;height:50px;" name="qc_loader" class="qc-frame"  frameBorder="0"></iframe></div>'),d.append(b);break;case"reveal":b=a('<div class="qc-loading"></div><iframe src="" class="qc-frame" scrolling="no" style="overflow:hidden;width:100%;height:50px;" name="qc_loader" frameBorder="0"></iframe>'),d.append(b);break;case"onpage":b=a('<div class="qc-loading"></div><iframe src="" scrolling="no" style="overflow:hidden;width:100%;height:50px;" name="qc_loader" class="qc-frame" frameBorder="0"></iframe>'),d.append(b),b.show();break;default:return}i.load_iframe_checkout(e)},get_iframe_src:function(){return g=quick_checkout.checkout_url+"?qc_loader=true","http:"==window.location.protocol&&(g=g.replace("https:","http:")),e.product_variations&&(e.product_variations=""),g+="&"+a.param(e)},load_iframe_checkout:function(a){g=i.get_iframe_src();var e=c.closest(".variations_form");if(quick_checkout.script_debug&&(console.log("QC Object:"),console.log(a),console.log("QC DOM Object:"),console.log(d),console.log("QC iFrame URL:"),console.log(g)),c.hasClass("quick-checkout-now")||c.hasClass("quick-checkout-link"))return b.find("iframe").attr("src",g),i.frame_loaded(),!1;if(e.length)return i.add_single_product_variation(e),!1;if(a.is_gform)return g=i.get_iframe_src(),b.is("iframe")?b.attr("src",g):b.find("iframe").attr("src",g),i.frame_loaded(),!1;var f={action:"wqc_add_to_cart",data:a};i.qc_ajax(f)},qc_ajax:function(e){g=i.get_iframe_src(),quick_checkout.script_debug&&(console.log("QC AJAX Data:"),console.log(e)),a.post(quick_checkout.ajax_url,e,function(e){return quick_checkout.script_debug&&(console.log("QC AJAX Response:"),console.log(e)),"empty_cart"==e?(alert(quick_checkout.i18n.cart_error),c.removeClass("loading").prop("disabled",!1),d.empty(),a.magnificPopup.instance.isOpen&&a.magnificPopup.close(),!1):(b.is("iframe")?b.attr("src",g):b.find("iframe").attr("src",g),i.frame_loaded(),!0)}).fail(function(){console.log(response),alert(quick_checkout.i18n.cart_error),c.removeClass("loading").prop("disabled",!1),d.empty()})},frame_loaded:function(){"reveal"!==e.checkout_action&&(c.removeClass("loading").prop("disabled",!1),a(".qc-loading").remove());var b=!1;quick_checkout.script_debug&&(b=!0),iFrameResize({inPageLinks:!0,enablePublicMethods:!0,log:b,messageCallback:function(b){return"undefined"==typeof b.message.result?!1:(console.log(e.checkout_action),"failure"==b.message.result&&(a("html, body").animate({scrollTop:a(d).offset().top-100},500),a(".mfp-wrap").animate({scrollTop:0},500)),void("reveal"==e.checkout_action&&(c.removeClass("loading").prop("disabled",!1),a(".qc-loading").hide().remove(),d.slideDown(),a("html, body").animate({scrollTop:d.offset().top-35},500))))},resizedCallback:function(b){a(".mfp-preloader").hide()}})},qc_get_object:function(a){return e=a.data(),c.parents("form").data("product_variations")&&(e.product_variations=c.parents("form").data("product_variations")),e.id&&(e.product_id=e.id,delete e.id),c.data("quantity")>1?e.quantity=c.data("quantity"):c.hasClass("single_add_to_cart_button")&&(e.quantity=c.parents("form").find("input.qty").val()),(c.hasClass("quick-checkout-link")||c.hasClass("quick-checkout-now"))&&(e.checkout_action="lightbox",e.clear_cart=!1,e.checkout_now=!0,e.product_id=0),e},qc_open_modal:function(){a.magnificPopup.open({items:{src:d,type:"inline"},callbacks:{open:function(){a(".mfp-preloader").show(),a(".quick-checkout-active-loading").removeClass("quick-checkout-active-loading"),a(document.body).on("checkout_error",function(){a(".mfp-wrap").animate({scrollTop:0},1e3)})},close:function(){a("#quick-checkout-modal").remove()}}})},add_single_product_variation:function(b){var d=b.find("input[name=variation_id]").val(),e=b.find("input[name=product_id]").val(),f=b.find("input[name=quantity]").val();a(".ajaxerrors").remove();var g={},h=!0,j=b.find("select[name^=attribute]");if(j.length||(j=b.find("[name^=attribute]:checked")),j.length||(j=b.find("input[name^=attribute]")),j.each(function(){var b,c,d=a(this),e=d.attr("name"),f=d.val();d.removeClass("error"),0===f.length?(b=e.lastIndexOf("_"),c=e.substring(b+1),d.addClass("required error").before('<div class="ajaxerrors"><p>Please select '+c+"</p></div>"),h=!1):g[e]=f}),!h)return!1;var k={action:"wqc_add_to_cart",product_id:e,quantity:f,variation_id:d,variation:g};return a("body").trigger("adding_to_cart",[c,k]),i.qc_ajax(k),!1},shop_checkout_now:function(){if("1"==quick_checkout.woocommerce_is_cart)return!1;if(!i.is_shop_checkout_now_enabled())return!1;var b=a(".products").find(".add_to_cart_button");b.on("click touchend",b,i.checkout_now)},checkout_now:function(){var b=a(this),c=a(this).data("product_sku"),d=a(this).data("product_id"),e=quick_checkout.shop_cart_reveal_text;quick_checkout.shortcode_shop_cart_reveal_text&&(e=quick_checkout.shortcode_shop_cart_reveal_text),a("body").on("added_to_cart",function(f){0==a(b).closest(".product").find(".quick-checkout-now").length&&a(b).after('<a href="#" class="quick-checkout-now quick-checkout-button-shop wc-forward" data-product_id="'+d+'" data-product_sku="'+c+'">'+e+"</a>")})},is_shop_checkout_now_enabled:function(){return"yes"==quick_checkout.shop_cart_reveal&&"1"==quick_checkout.woocommerce_is_shop&&"yes"==quick_checkout.shop_on?!0:"yes"==quick_checkout.shortcode_shop_cart_reveal&&"1"!==quick_checkout.woocommerce_is_shop?!0:!1},gravity_form_support:function(){var b=a("form.cart"),c=b.serializeArray();a.post(quick_checkout.ajax_url,c,function(b){return 0==b?(a(".single_add_to_cart_button").trigger("click"),!1):(e.is_gform=!0,void i.qc_open_checkout(e))}).fail(function(){alert(quick_checkout.i18n.cart_error)})},hide_all_except_checkout:function(){var b=a("body.quick-checkout-frame"),c=a(b).find(".woocommerce");c.prependTo(b),c.siblings().hide(),c.parents().siblings().hide(),b.show(),c.show()},window_load:function(){a(".quick-checkout-button-image-overlay").each(function(b,c){i.center_div(a(c),0,0)}),i.shop_checkout_now(),a(".quick-checkout-product_quick_checkout").each(function(){var b=a(this).find(".add_to_cart_button");b.on("click touchend",b,i.checkout_now)})},center_div:function(b,c,d){var e=b.closest(".product").find(".wp-post-image");0===e.length&&(e=b.closest(".product").find("img"));var f=parseInt(e.outerWidth())/2-parseInt(b.outerWidth())/2-c,g=parseInt(e.outerHeight())/2-parseInt(b.outerHeight())/2-d;if(b.hasClass("quick-checkout-button-overlay-single")){e=b.closest(".images").find(".wp-post-image");var h,i,j;e.each(function(){i?this.width>i&&(h=a(this),i=this.width,j=this.height):(h=a(this),i=this.width,j=this.height)}),f=parseInt(i)/2-parseInt(b.outerWidth())/2-c,g=parseInt(j)/2-parseInt(b.outerHeight())/2-d}b.css({top:g,left:f}).addClass("qc-buy-now-centered")},login_form_submitted:function(a){h[0].hasAttribute("action")&&""!=h.attr("action")||(a.preventDefault(),h.attr("action",quick_checkout.checkout_url),h.submit())}};a(function(){i.init()})}(jQuery);