!function(){tinymce.PluginManager.add("wqc_shortcode_button",function(a,b){function c(b,c){a.windowManager.open({title:"Quick Checkout",id:"wqc_shortcode_dialog",width:600,height:450,resizable:!0,scrollbars:!0,url:ajaxurl+"?action=wqc_shortcode_iframe"},{shortcode:h.getLang("wqc.shortcode_tag"),shortcode_params:window.decodeURIComponent(c)})}function d(a,b){return b=new RegExp(b+'="([^"]+)"',"g").exec(a),b?window.decodeURIComponent(b[1]):""}function e(a){return a.replace(/\[woocommerce-quick-checkout([^\]]*)\]/g,function(a,b,c){return g("wp-woocommerce-quick-checkout",b,c)})}function f(a){return a.replace(/(?:<p(?: [^>]+)?>)*(<img [^>]+>)(<\/p>)*/g,function(a,b){var c=d(b,"data-wqc-attr");return c?"<p>["+i+c+"]</p>":a})}function g(a,c,d){var e=b+"/shortcode-placeholder.jpg";return c=window.encodeURIComponent(c),'<img src="'+e+'" class="mceItem '+a+'" data-wqc-attr="'+c+'" data-mce-resize="false" data-mce-placeholder="1" />'}var h=tinymce.activeEditor,i="woocommerce-quick-checkout";a.addCommand("wqc_shortcode_popup",c),a.addButton("wqc_shortcode_button",{title:"Quick Checkout",icon:"gpr dashicons-cart",onclick:c}),a.on("BeforeSetcontent",function(a){a.content=e(a.content)}),a.on("GetContent",function(a){a.content=f(a.content)}),a.on("DblClick",function(b){var c=b.target.className.indexOf("wp-woocommerce-quick-checkout"),d=b.target.attributes["data-wqc-attr"].value;"IMG"==b.target.nodeName&&c>-1&&a.execCommand("wqc_shortcode_popup",!1,d)})})}();